<div class="bg-white shadow rounded-lg p-6">
  <h3 class="text-lg font-medium text-gray-900 mb-6">Timeline du projet</h3>
  
  <div class="flow-root">
    <ul role="list" class="-mb-8">
      <% phases.each_with_index do |phase, index| %>
        <li>
          <div class="relative pb-8">
            <!-- Connector line (except for last item) -->
            <% unless index == phases.count - 1 %>
              <span class="absolute left-4 top-4 -ml-px h-full w-0.5 bg-gray-200" aria-hidden="true"></span>
            <% end %>
            
            <div class="relative flex space-x-3">
              <!-- Phase icon -->
              <div>
                <span class="h-8 w-8 rounded-full <%= phase_status_class(phase) %> flex items-center justify-center ring-8 ring-white">
                  <svg class="h-5 w-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="<%= phase_icon(phase) %>"></path>
                  </svg>
                </span>
              </div>
              
              <!-- Phase content -->
              <div class="flex-1 min-w-0">
                <div class="<%= is_current_phase?(phase) ? 'ring-2 ring-blue-500 bg-blue-50' : 'bg-gray-50' %> rounded-lg p-4">
                  <div class="flex items-center justify-between mb-2">
                    <h4 class="text-sm font-medium text-gray-900">
                      <%= phase.name %>
                      <% if is_current_phase?(phase) %>
                        <span class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                          Actuelle
                        </span>
                      <% end %>
                    </h4>
                    <span class="text-sm text-gray-500">
                      <%= formatted_duration(phase) %>
                    </span>
                  </div>
                  
                  <div class="text-sm text-gray-600 mb-3">
                    <%= phase.description if phase.description.present? %>
                  </div>
                  
                  <!-- Progress bar -->
                  <div class="mb-2">
                    <div class="flex items-center justify-between text-xs mb-1">
                      <span class="text-gray-500">Avancement</span>
                      <span class="font-medium text-gray-900"><%= phase.completion_percentage %>%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-1.5">
                      <div class="<%= phase_status_class(phase) %> h-1.5 rounded-full transition-all duration-300" 
                           style="width: <%= phase_progress_width(phase) %>"></div>
                    </div>
                  </div>
                  
                  <!-- Phase details -->
                  <div class="grid grid-cols-2 gap-4 text-xs text-gray-500">
                    <div>
                      <span class="font-medium">Début:</span>
                      <%= phase.start_date&.strftime('%d/%m/%Y') || 'À définir' %>
                    </div>
                    <div>
                      <span class="font-medium">Fin:</span>
                      <%= phase.end_date&.strftime('%d/%m/%Y') || 'À définir' %>
                    </div>
                  </div>
                  
                  <!-- Phase actions -->
                  <div class="mt-3 flex space-x-2">
                    <%= link_to "Voir détails", [phase.project, phase], 
                                class: "text-xs font-medium text-indigo-600 hover:text-indigo-500" %>
                    <% if phase.tasks.any? %>
                      <span class="text-gray-300">•</span>
                      <span class="text-xs text-gray-500"><%= pluralize(phase.tasks.count, 'tâche') %></span>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </li>
      <% end %>
    </ul>
  </div>
  
  <!-- Timeline summary -->
  <div class="mt-6 pt-6 border-t border-gray-200">
    <div class="grid grid-cols-3 gap-4 text-center">
      <div>
        <span class="block text-lg font-semibold text-gray-900">
          <%= phases.where(status: 'completed').count %>
        </span>
        <span class="text-sm text-gray-500">Terminées</span>
      </div>
      <div>
        <span class="block text-lg font-semibold text-gray-900">
          <%= phases.where(status: 'in_progress').count %>
        </span>
        <span class="text-sm text-gray-500">En cours</span>
      </div>
      <div>
        <span class="block text-lg font-semibold text-gray-900">
          <%= phases.where(status: 'pending').count %>
        </span>
        <span class="text-sm text-gray-500">À venir</span>
      </div>
    </div>
  </div>
</div>